{% extends "polls/base.html" %}
{% block title %}My Polls Dashboard{% endblock %}
{% block content %}

<!-- Dashboard Header -->
<div class="dashboard-header">
  <div class="dashboard-title">
    <h1 class="dashboard-heading">ğŸ“Š My Polls Dashboard</h1>
    <p class="dashboard-subtitle">Create, manage, and analyze your community polls</p>
  </div>
  <a href="{% url 'create_poll' %}" class="btn btn-create-poll">+ Create New Poll</a>
</div>

<!-- Stats Section -->
{% if polls %}
<div class="dashboard-stats">
  <div class="stat-card">
    <div class="stat-icon-bg" style="background: linear-gradient(135deg, #e0e7ff 0%, #ddd6fe 100%);">
      <div class="stat-icon">ğŸ“Š</div>
    </div>
    <div class="stat-content">
      <p class="stat-label">Total Polls Created</p>
      <p class="stat-value">{{ polls|length }}</p>
    </div>
  </div>
  <div class="stat-card">
    <div class="stat-icon-bg" style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);">
      <div class="stat-icon">âœ¨</div>
    </div>
    <div class="stat-content">
      <p class="stat-label">Active Polls</p>
      <p class="stat-value">{% regroup polls by is_active as grouped %}{% for active, items in grouped %}{% if active %}{{ items|length }}{% else %}0{% endif %}{% endfor %}</p>
    </div>
  </div>
  <div class="stat-card">
    <div class="stat-icon-bg" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);">
      <div class="stat-icon">ğŸ—³ï¸</div>
    </div>
    <div class="stat-content">
      <p class="stat-label">Total Engagement</p>
      <p class="stat-value">{{ total_votes }}</p>
    </div>
  </div>
</div>
{% endif %}

<!-- Polls Grid -->
{% if polls %}
<div class="polls-container">
  <h2 class="section-title">Your Polls</h2>
  <div class="polls-grid">
    {% for poll in polls %}
    <div class="poll-card enhanced-poll-card">
      <div class="poll-card-header">
        <div class="poll-status-group">
          <span class="poll-status {% if poll.is_active %}status-active{% else %}status-inactive{% endif %}">
            {% if poll.is_active %}<span class="status-badge active-badge">ğŸŸ¢ Active</span>{% else %}<span class="status-badge inactive-badge">â­• Inactive</span>{% endif %}
          </span>
          <span class="poll-category category-{{ poll.category }}">{{ poll.get_category_display }}</span>
        </div>
      </div>
      <div class="poll-card-body">
        <h3 class="poll-question"><a href="{% url 'poll_detail' poll.id %}">{{ poll.question }}</a></h3>
        {% if poll.description %}
          <p class="poll-description">{{ poll.description|truncatewords:20 }}</p>
        {% endif %}
      </div>
      <div class="poll-card-stats">
        <div class="poll-stat">
          <span class="poll-stat-icon">ğŸ—³ï¸</span>
          <span class="poll-stat-value"><strong>{{ poll.total_votes }}</strong> vote{{ poll.total_votes|pluralize }}</span>
        </div>
        <div class="poll-stat">
          <span class="poll-stat-icon">ğŸ“…</span>
          <span class="poll-stat-value">Created {{ poll.created_at|date:"M j, Y" }}</span>
        </div>
      </div>
      <div class="poll-card-actions">
        <a href="{% url 'poll_results' poll.id %}" class="action-btn action-results" title="View poll results">ğŸ“ˆ Results</a>
        <a href="{% url 'poll_detail' poll.id %}" class="action-btn action-view" title="View full poll page">ğŸ‘ï¸ View</a>
        <form method="post" action="{% url 'deactivate_poll' poll.id %}" style="display:inline" title="{% if poll.is_active %}Pause this poll{% else %}Resume this poll{% endif %}">
          {% csrf_token %}
          <button type="submit" class="action-btn action-toggle">
            {% if poll.is_active %}â¸ï¸ Pause{% else %}â–¶ï¸ Resume{% endif %}
          </button>
        </form>
        <a href="{% url 'delete_poll' poll.id %}" class="action-btn action-delete" title="Delete this poll">ğŸ—‘ï¸ Delete</a>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% else %}
<div class="empty-dashboard">
  <div class="empty-icon">ğŸ“­</div>
  <h2>No Polls Yet</h2>
  <p>Start creating polls to build your collection and engage your community!</p>
  <a href="{% url 'create_poll' %}" class="btn btn-primary btn-large">Create Your First Poll</a>
</div>
{% endif %}

{% endblock %}
