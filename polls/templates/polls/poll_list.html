{% extends "polls/base.html" %}
{% block title %}Active Polls{% endblock %}
{% block content %}
<div class="page-header">
    <h1>Active Polls</h1>
    {% if user.is_authenticated %}
    <a href="{% url 'create_poll' %}" class="btn">+ Create Poll</a>
    {% endif %}
</div>

<div class="category-filter">
    <span>Filter by category:</span>
    {% for code, label in categories %}
        <a href="?category={{ code }}" class="category-badge {% if selected_category == code %}active{% endif %}">{{ label }}</a>
    {% endfor %}
</div>

{% if polls %}
{% for poll in polls %}
<div class="card">
    <div class="card-header">
        <h2><a href="{% url 'poll_detail' poll.id %}">{{ poll.question }}</a></h2>
        <span class="category-badge category-{{ poll.category }}">{{ poll.get_category_display }}</span>
    </div>
    <p class="card-meta">
        <span class="stat"><strong>{{ poll.total_votes }}</strong> vote{{ poll.total_votes|pluralize }}</span>
        {% if poll.created_by %}
        &nbsp;&middot;&nbsp; by {{ poll.created_by.username }}
        {% endif %}
    </p>
    <div class="btn-group">
        <a href="{% url 'poll_detail' poll.id %}" class="btn">Vote</a>
        <a href="{% url 'poll_results' poll.id %}" class="btn btn-secondary btn-sm">Results</a>
    </div>
</div>
{% endfor %}
{% else %}
<div class="card empty-state">
    <p>No active polls yet.</p>
    {% if user.is_authenticated %}
    <a href="{% url 'create_poll' %}" class="btn">Create the first poll</a>
    {% else %}
    <a href="{% url 'register' %}" class="btn">Register to create polls</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}